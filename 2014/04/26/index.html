<!doctype html>
<!-- original: http://vector.io/vector-map/ by Brett Camper -->
<html>
<head>
<meta charset="utf-8">
<title>MVT Vector Tiles on Leaflet 0.8</title>
<style>
body {margin: 0px; border: 0px; padding: 0px;}
#map {background: rgba(0, 0, 0, 0);}
.label {width: 200px; margin-left: -100px; position: absolute;
  z-index: 10; text-align: center;}
.labelInner {padding: 2px; background: white; opacity: 0.75;}
</style>
<link rel="stylesheet" href="leaflet-0.8-dev.css">
</head>
<body>
<div id="map">
<script src="leaflet-0.8-dev.js"></script>
<script src="vector-map.debug.js"></script>
<script>
var map = L.map('map', {});
map.attributionControl.setPrefix('');
map.setView([36.088, 140.104], 15);

function resizeMap () {
  document.getElementById('map').style.width = window.innerWidth + 'px';
  document.getElementById('map').style.height = window.innerHeight + 'px';
  map.invalidateSize(false);
}
window.addEventListener('resize', resizeMap);
resizeMap();

/*** Layer ***/
var layer = L.vectorTileLayer({
  vectorRenderer: '',
  vectorTileSource: {type: 'MapboxTileSource',
    url: 'http://a.tiles.mapbox.com/v3/mapbox.mapbox-streets-v4/' + 
      '{z}/{x}/{y}.vector.pbf',
    max_zoom: 14},
  vectorLayers: 'gl_layers_mvt.js',
  vectorStyles: 'gl_styles.js',
  numWorkers: 1,
  attribution: 'Map data &copy; OpenStreetMap contributors / ' + 
    'original code: http://vector.io/vector-map/' ,
  unloadInvisibleTiles: false,
  updateWhenIdle: false
});

/***** Render loop *****/
window.addEventListener('load', function () {
  layer.addTo(map);
  frameLoop();
});

function frame () {
  layer.render();
}

function frameLoop () {
  frame();
  requestAnimationFrame(frameLoop);
}

// Cross-browser compatibility for requestAnimationFrame
(function requestAnimationFrameCompatibility () {
    if (window.requestAnimationFrame == undefined) {
        window.requestAnimationFrame = (function () {
            return (
                window.requestAnimationFrame       ||
                window.webkitRequestAnimationFrame ||
                window.mozRequestAnimationFrame    ||
                window.oRequestAnimationFrame      ||
                window.msRequestAnimationFrame     ||
                function (callback) {
                   window.setTimeout(callback, 1000 / 60);
                }
            );
        })();
    }
}());
</script>
</body>
</html>
